var t=function(){return t=Object.assign||function(t){for(var i,n=1,s=arguments.length;n<s;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},t.apply(this,arguments)};function i(t,i){return Math.random()*(i-t)+t}"function"==typeof SuppressedError&&SuppressedError;var n=2*Math.PI,s=function(){function t(t){var s=t.isRocket,e=void 0!==s&&s,o=t.hue,h=void 0===o?i(1,360):o,r=t.brightness,a=void 0===r?i(50,60):r,c=t.position;if(this.isRocket=e,this.position=c,this.positions=[this.position,this.position,this.position],this.isRocket)this.velocity={x:i(-3,3),y:i(-7,-3)},this.shrink=.999,this.resistance=1;else{var l=i(0,n),p=15*Math.cos(i(0,n));this.velocity={x:Math.cos(l)*p,y:Math.sin(l)*p},this.shrink=i(0,.05)+.93,this.resistance=.92}this.gravity=.01,this.size=3,this.alpha=1,this.fade=0,this.hue=h,this.brightness=a}return t.prototype.clone=function(){return new t({position:{x:this.position.x,y:this.position.y},hue:this.hue,brightness:this.brightness})},t.prototype.shouldRemove=function(t,i){return this.alpha<=.1||this.size<=1||(this.position.x>t||this.position.x<0||(this.position.y>i||this.position.y<0))},t.prototype.shouldExplode=function(t,n,s){return!!this.isRocket&&(this.position.y<=t||!(this.position.y>=n)&&i(0,1)<=s)},t.prototype.update=function(){this.positions.pop(),this.positions.unshift({x:this.position.x,y:this.position.y}),this.velocity.x*=this.resistance,this.velocity.y*=this.resistance,this.velocity.y+=this.gravity,this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.size*=this.shrink,this.alpha-=this.fade},t.prototype.draw=function(t){var i=this.positions[this.positions.length-1];t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(this.position.x,this.position.y),t.lineWidth=this.size,t.lineCap="round",t.strokeStyle="hsla(".concat(this.hue,", 100%, ").concat(this.brightness,"%, ").concat(this.alpha,")"),t.stroke()},t}(),e=function(){function n(t){var i=t.maxRockets,n=t.numParticles,s=t.cw,e=t.ch,o=t.rocketInitialPoint,h=t.cannons;this._set=new Set,this.rockets=0,this.maxRockets=i,this.numParticles=n,this.cw=s,this.ch=e,this.rocketInitialPoint=o,this.cannons=h,this.rocketInitialPoint&&this.cannons.push({x:this.rocketInitialPoint,y:this.ch})}return n.prototype.size=function(){return this._set.size},n.prototype.entries=function(){return this._set},n.prototype.clear=function(){this._set.clear(),this.rockets=0},n.prototype.delete=function(t){this._set.delete(t),t.isRocket&&this.rockets--},n.prototype.add=function(t){this._set.add(t)},n.prototype.explode=function(t){for(var i=0;i<this.numParticles;i+=1)this.add(t.clone());this.delete(t)},n.prototype.spawnRocket=function(){this.rockets++;var n=Math.floor(i(0,this.cannons.length)),e=this.cannons[n]||{};this.add(new s({isRocket:!0,position:t(t(t({},e),null==e.x&&{x:i(0,this.cw)}),null==e.y&&{y:this.ch})}))},n.prototype.spawnRockets=function(){this.rockets<this.maxRockets&&this.spawnRocket()},n}(),o=function(){function t(t,i){var n=void 0===i?{}:i,s=n.rocketSpawnInterval,o=void 0===s?150:s,h=n.maxRockets,r=void 0===h?3:h,a=n.numParticles,c=void 0===a?100:a,l=n.explosionMinHeight,p=void 0===l?.2:l,u=n.explosionMaxHeight,d=void 0===u?.9:u,y=n.explosionChance,f=void 0===y?.08:y,v=n.width,w=void 0===v?t.clientWidth:v,x=n.height,m=void 0===x?t.clientHeight:x,k=n.rocketInitialPoint,g=void 0===k?null:k,R=n.cannons,I=void 0===R?[]:R;this.finishCallbacks=[],this.container=t,this.rocketSpawnInterval=o,this.maxRockets=r,this.cw=w,this.ch=m,this.maxH=this.ch*(1-d),this.minH=this.ch*(1-p),this.chance=f,this.pixelRatio=window.devicePixelRatio||1,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),t.appendChild(this.canvas),this.things=new e({maxRockets:this.maxRockets,numParticles:c,cw:this.cw,ch:this.ch,rocketInitialPoint:g,cannons:I}),this.updateDimensions()}return t.prototype.destroy=function(){this.canvas.parentElement.removeChild(this.canvas),window.clearInterval(this.interval),window.cancelAnimationFrame(this.rafInterval)},t.prototype.start=function(){var t=this;if(null==this.interval)return this.interval=window.setInterval((function(){return t.things.spawnRockets()}),this.rocketSpawnInterval),this.rafInterval=window.requestAnimationFrame((function(){return t.update()})),function(){return t.stop()}},t.prototype.updateDimensions=function(){this.canvas.width=this.cw*this.pixelRatio,this.canvas.height=this.ch*this.pixelRatio,this.canvas.style.width="".concat(this.cw,"px"),this.canvas.style.height="".concat(this.ch,"px"),this.ctx.scale(this.pixelRatio,this.pixelRatio),this.things.cw=this.cw,this.things.ch=this.ch},t.prototype.setSize=function(t,i){this.cw=t,this.ch=i,this.updateDimensions()},t.prototype.resetSize=function(){this.cw=this.container.clientWidth,this.ch=this.container.clientHeight,this.updateDimensions()},t.prototype.stop=function(){window.clearInterval(this.interval),this.interval=null},t.prototype.kill=function(){this.things.clear(),this.stop(),window.cancelAnimationFrame(this.rafInterval),this._finish()},t.prototype.fire=function(){var t=this;this.things.spawnRocket(),this.rafInterval||(this.rafInterval=window.requestAnimationFrame((function(){return t.update()})))},t.prototype.onFinish=function(t){this.finishCallbacks.push(t)},t.prototype._clear=function(t){void 0===t&&(t=!1),this.ctx.globalCompositeOperation="destination-out",this.ctx.fillStyle="rgba(0, 0, 0 ".concat(t?"":", 0.5",")"),this.ctx.fillRect(0,0,this.cw,this.ch),this.ctx.globalCompositeOperation="lighter"},t.prototype._finish=function(){this._clear(!0),this.rafInterval=null,this.finishCallbacks.forEach((function(t){return t()}))},t.prototype.update=function(){var t,i,n=this;this._clear();try{for(var s=function(t){var i="function"==typeof Symbol&&Symbol.iterator,n=i&&t[i],s=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.things.entries()),e=s.next();!e.done;e=s.next()){var o=e.value;o.draw(this.ctx),o.update(),o.shouldRemove(this.cw,this.ch)?this.things.delete(o):o.shouldExplode(this.maxH,this.minH,this.chance)&&this.things.explode(o)}}catch(i){t={error:i}}finally{try{e&&!e.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}this.interval||this.things.size()>0?this.rafInterval=window.requestAnimationFrame((function(){return n.update()})):this._finish()},t}(),h=document.getElementById("container"),r=document.getElementById("spawn"),a=document.getElementById("kill"),c=document.getElementById("stop"),l=document.getElementById("start"),p=h.clientWidth,u=new o(h,{maxRockets:15,rocketSpawnInterval:50,numParticles:200,explosionMinHeight:.2,explosionMaxHeight:.9,explosionChance:.02,cannons:[{x:.2*p},{x:.8*p}],rocketInitialPoint:.5*p});function d(t){void 0===t&&(t=!1),a.style.display="none",c.style.display="none",l.style.display="",t?u.kill():u.stop()}function y(){a.style.display="",c.style.display="",l.style.display="none",u.start()}y(),document.addEventListener("keydown",(function(t){return 27===t.which&&d()})),r.addEventListener("click",(function(){return u.fire()})),a.addEventListener("click",(function(){return d(!0)})),c.addEventListener("click",(function(){return d(!1)})),l.addEventListener("click",(function(){return y()})),window.addEventListener("resize",(function(){return u.resetSize()}));
//# sourceMappingURL=fireworks.js.map
